Create schema Taller_Mecanico;

USE Taller_Mecanico;


Create table Vehiculo (
ID_vehiculo INT not null auto_increment primary key,
modelo varchar (30),
marca varchar (30),
color varchar (15)
);

Create table Cliente (
ID_cliente INT not null auto_increment,
ID_vehiculo INT,
ID_Falla INT,
nombre varchar (30),
apellido varchar (30),
contacto INT,
direccion varchar (30),
primary key (ID_cliente)
);


Create table Falla (
ID_falla INT not null auto_increment,
Categoria varchar (30),
Prioridad varchar (30),  -- En esta parte tengo pensado utilizar la siguiente forma de definir la prioridad (importantes/urgentes, importantes/no urgentes, importantes/urgentes,importantes/no urgentes) Contexto la idea surge de el libro "Los 7 hábitos de la gente altamente efectiva" habito N°3 Poner primero lo primero
Fecha_ingreso date,
Fecha_termino date,
primary key (ID_falla)
);

Create table Mecanico (
ID_mecanico INT NOT NULL auto_increment,
ID_repuesto INT NOT NULL,
ID_falla INT,
nombre varchar (30),
Apellido varchar (30),
diagnostico text (40),
solucion text (50),
primary key (ID_mecanico)
);


Create table Repuesto (
ID_repuesto INT not null auto_increment,
Repuesto varchar (30),
Cantidad INT,
Proveedor varchar (40),
fecha_uso date,
primary key (ID_repuesto) 
);


Create table Facturacion (
ID_facturacion INT not null,
ID_cliente INT,
ID_vehiculo INT,
ID_falla INT,
ID_mecanico INT,
ID_repuesto INT,
fecha_emision date, 
Costo_Reparacion INT,
primary key (ID_facturacion)
);




-- Alters



ALTER TABLE Cliente
ADD CONSTRAINT FK_Vehiculo_Cliente FOREIGN KEY (ID_vehiculo) REFERENCES Vehiculo (ID_vehiculo),
ADD CONSTRAINT FK_Cliente_Falla FOREIGN KEY (ID_falla) REFERENCES Falla (ID_falla);

ALTER TABLE Mecanico
ADD CONSTRAINT FK_repuesto_mecanico FOREIGN KEY (ID_repuesto) REFERENCES Repuesto (ID_repuesto),
ADD CONSTRAINT FK_mecanico_falla FOREIGN KEY (ID_falla) REFERENCES Falla (ID_falla);


ALTER TABLE Facturacion 
ADD CONSTRAINT FK_cliente FOREIGN KEY (ID_cliente) REFERENCES Cliente (ID_cliente), 
ADD CONSTRAINT FK_vehiculo FOREIGN KEY (ID_vehiculo)REFERENCES Vehiculo (ID_Vehiculo),
ADD CONSTRAINT FK_falla FOREIGN KEY (ID_falla) REFERENCES falla (ID_falla),
ADD CONSTRAINT FK_mecanico FOREIGN KEY (ID_mecanico) REFERENCES Mecanico (ID_mecanico),
ADD CONSTRAINT FK_repuesto FOREIGN KEY (ID_repuesto) REFERENCES Repuesto (ID_repuesto)
;

